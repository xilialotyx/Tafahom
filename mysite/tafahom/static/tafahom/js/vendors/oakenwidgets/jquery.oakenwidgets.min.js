!function (e) { "use strict"; function s() { var e = o.find(t); e.sortable({ connectWith: e, placeholder: "oaken-placeholder", start: function (e, t) { t.placeholder.height(t.helper.outerHeight()) }, stop: function (e, t) { d() }, containment: o, helper: "clone", handle: ".panel-heading" }) } function l() { e(".oaken-clear").click(function (e) { e.preventDefault(), e.stopPropagation(), u("Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ Ú†ÛŒØ²", "ÙˆØ§Ù‚Ø¹Ø§ Ù…Ø·Ù…Ø¹Ù†ÛŒ ØŸØŸ", f) }), r() } function r() { if (i.persistence) { if ("local" === i.persistence) { if ("undefined" == typeof window.localStorage) return void console.error("localStorage is undefined, persistence features will not work."); c(window.localStorage.getItem(o.attr("id"))) } else "remote" === i.persistence && e.get(i.remoteURL, c) } } function c(a) { var n = JSON.parse(a); if (n) { if (n.order) { var s = n.order, l = e(".panel", o); e.each(s, function (a, r) { var c = e(t, o).eq(a); e.each(s[a], function (t, o) { var a = o.split(":")[0], s = o.split(":")[1], r = l.filter("#" + a); r && (r.detach(), s && a !== n.fullscreen && (e(".panel-body", r).hide(), e(".panel-heading .btn-minmax i", r).removeClass(i.controlsConfig.minmax.iClassFirst).addClass(i.controlsConfig.minmax.iClassSecond), r.data("collapsed", !0)), c.append(r)) }) }) } if (n.fullscreen) { var r = e("#" + n.fullscreen), c = { scroll: e(window).scrollTop(), top: r.offset().top - e(window).scrollTop(), left: r.offset().left, width: r.width(), height: r.height(), position: r.css("position"), "z-index": r.css("z-index") }; r.css({ position: "fixed", top: 0, left: 0, "z-index": 999999, width: "100%", height: "100%" }).data("initial", c).addClass("panel-fullscreen"), e(".oakenwidget-control", r).not(".btn-fullscreen").toggle(), e(".btn-fullscreen", r).find("i").toggleClass(i.controlsConfig.fullscreen.iClassFirst).toggleClass(i.controlsConfig.fullscreen.iClassSecond) } } } function d() { if (i.persistence) { var a = {}; 1 === e(".panel-fullscreen").length ? a.fullscreen = e(".panel-fullscreen").attr("id") : delete a.fullscreen; var n = []; if (o.is(".row") && e(t, o).each(function () { var t = e(this), i = []; e(".panel", t).each(function () { var t = e(this).attr("id"); e(this).data("collapsed") && (t += ":min"), i.push(t) }), n.push(i) }), a.order = n, "local" === i.persistence) { if ("undefined" == typeof window.localStorage) return; window.localStorage.setItem(o.attr("id"), JSON.stringify(a)) } else "remote" === i.persistence && e.post(i.remoteURL, { structure: JSON.stringify(a) }) } } function f() { if (i.persistence) if ("local" === i.persistence) { if ("undefined" == typeof window.localStorage) return; window.localStorage.removeItem(o.attr("id")), window.location.reload() } else "remote" === i.persistence && e.ajax({ type: "DELETE", url: i.remoteURL, success: function () { window.location.reload() } }) } function p() { var t = '<div class="modal modal-danger-filled oaken-confirm" data-easein="bounceIn" data-easeout="bounceOut" tabindex="-1" role="dialog" aria-hidden="true"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><h4 class="modal-title"></h4></div><div class="modal-body"><span></span></div><div class="modal-footer"><button type="button" class="btn btn-default" data-dismiss="modal">Ø¨Ù„Ù‡</button><button type="button" class="btn btn-default accept">Ø®ÛŒØ±</button></div></div></div></div>'; e("body").append(e(t)) } function u(t, i, o) { var a = e(".oaken-confirm"); a.find(".modal-title").text(t), a.find(".modal-body span").text(i), a.find(".accept").off("click.oaken").on("click.oaken", function () { o(), a.modal("hide") }), a.modal("show") } function h(t) { var i; i = e(".panel-body", t).length ? e(".panel-body", t) : t, i.append('<div class="ow-veil"><span class="ow-spinner"><i class="glyphicon glyphicon-refresh ow-rotate"></i></span></div>') } function g(t) { e(".ow-veil", t).remove() } var i, o, t = "div[class^=col-md-]", a = { sortable: !0, controlsConfig: { question: { iClassFirst: "fa fa-question" }, fullscreen: { iClassFirst: "fa fa-expand", iClassSecond: "fa fa-compress" }, minmax: { iClassFirst: "fa fa-chevron-up", iClassSecond: "fa fa-chevron-down" }, close: { iClassFirst: "fa fa-times" } }, controlsMap: {}, persistence: "local", remoteURL: "/", ajaxLoad: "", ajaxStarted: function () { this.css("position", "relative"), h(this) }, ajaxCompleted: function (t) { e(".panel-body", this).length ? e(".panel-body", this).empty().html(t) : this.append(e(t)), this.css("position", "static"), g(this) }, ajaxFailed: function (t) { this.css("position", "static"), g(this), 404 === t && this.append(e("<p>404: Not Found</p>")) } }, n = { fullscreen: { attributes: { "class": "btn-fullscreen oakenwidget-control" }, behaviour: function (a) { var r, n = e(this).data("w"), l = e(".oakenwidget-control", n); a.preventDefault(), a.stopPropagation(), n.toggleClass("panel-fullscreen"), n.data("collapsed") && e(".panel-body", n).toggle(n.is(".panel-fullscreen")); o.find(t); n.is(".panel-fullscreen") ? (r = { scroll: e(window).scrollTop(), top: n.offset().top - e(window).scrollTop(), left: n.offset().left, width: n.width(), height: n.height(), position: n.css("position"), "z-index": n.css("z-index") }, n.css({ position: "fixed", top: r.top, left: r.left, width: r.width, height: r.height, "z-index": 999999 }).animate({ width: "100%", height: "100%", top: 0, left: 0 }, 500, function () { i.sortable && o.find(t).sortable("destroy"), d() }).data("initial", r), e("body").css("overflow", "hidden")) : (r = n.data("initial"), n.animate({ top: r.top, left: r.left, width: r.width, height: r.height }, 500, function () { n.css({ position: r.position, "z-index": r["z-index"], width: r.width, height: r.height }), e(window).scrollTop(r.scroll), i.sortable && (n.css({ width: "100%", height: "auto" }), s(), e("body").css("overflow", "auto"), d()) }).data("initial", void 0)), l.not(this).toggle(), e(this).find("i").toggleClass(i.controlsConfig.fullscreen.iClassFirst).toggleClass(i.controlsConfig.fullscreen.iClassSecond) } }, minmax: { attributes: { "class": "btn-minmax oakenwidget-control" }, behaviour: function (t) { t.preventDefault(), t.stopPropagation(); var o = e(this).data("w"); e("i", e(this)).toggleClass(i.controlsConfig.minmax.iClassFirst).toggleClass(i.controlsConfig.minmax.iClassSecond), e(".panel-body", o).slideToggle(function () { o.data("collapsed", !e(".panel-body", o).is(":visible")), d() }) } }, close: { attributes: { "class": "btn-close oakenwidget-control" }, behaviour: function (t) { t.preventDefault(), t.stopPropagation(); var i = e(this).data("w"); u("Ø­Ø°Ù Ú©Ø±Ø¯Ù†", "ÙˆØ§Ù‚Ø¹Ø§ Ù…Ø·Ù…Ø¹Ù†ÛŒ ØŸØŸ", function () { i.fadeOut().remove(), d() }) } } }; e.fn.oakenwidgets = function (t) { if (1 !== this.length) throw new Error("only one oakenwidgets container per page is supported"); var r = !1; if (this.is(".row")) r = !0; else { var c = !0; this.children().each(function () { return e(this).is(".row") ? void 0 : void (c = !1) }), r = c } if (!r) throw new Error("oakenwidgets must be a bs row or something containing rows and only rows"); i = e.extend(a, t), o = this; var d = i.controlsMap; return o.find(".panel").each(function () { var t = e(this), o = t.attr("id"), a = e('<div class="pull-left"></div>'), s = e('<div class="clearfix"></div>'), l = t.data("controls-map"); "string" == typeof l && (d[o] = t.data("controls-map")), e.each(n, function (n, s) { if ("string" != typeof d[o] || -1 !== d[o].indexOf(n)) { var l = e('<a href="#"><i class="' + i.controlsConfig[n].iClassFirst + '"></i></a>'); e.each(s.attributes, function (e, t) { "data-target" === e && (t = t.replace("{id}", o)), l.attr(e, t) }), l.data("w", t), l.click(s.behaviour), l.appendTo(a) } }); var r = t.data("ajax-load"); r && ("function" == typeof i.ajaxStarted && i.ajaxStarted.call(t), e.ajax({ method: "GET", url: r, success: function (e) { "function" == typeof i.ajaxCompleted && i.ajaxCompleted.call(t, e) }, error: function (e) { "function" == typeof i.ajaxFailed && i.ajaxFailed.call(t, e.status) } })), e(".panel-heading", t).append(a).append(s) }), i.sortable && s(), p(), o.show(), l(), o } }(jQuery);